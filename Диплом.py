#!/usr/bin/env python
# coding: utf-8

# # –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ Python –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑.
# - –ê–≤—Ç–æ—Ä:–¢–∞—Å–∫–∞–µ–≤ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω
# - –î–∞—Ç–∞: 30.06.2025
# - —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–∞—à–±–æ—Ä–¥ –ø–æ –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞: https://datalens.yandex/1opjgckjxe9wm

# ## –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞
# 
# –ü—Ä–æ–≤–µ—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ Python, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å –∏–Ω—Å–∞–π—Ç—ã –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π –æ—Å–µ–Ω—å—é 2024 –≥–æ–¥–∞, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–∑–Ω–∏—Ü–µ –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –º–æ–±–∏–ª—å–Ω—ã–º–∏ –∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.
# 

# ## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
# –í –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–∏—Å–µ –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 –∏—é–Ω—è –ø–æ 30 –æ–∫—Ç—è–±—Ä—è 2024 –≥–æ–¥–∞ –≤ –≤–∏–¥–µ –¥–≤—É—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:
# –ü–µ—Ä–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç `final_tickets_orders_df.csv` –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–∞—Ö –±–∏–ª–µ—Ç–æ–≤, —Å–æ–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö —Å –¥–≤—É—Ö —Ç–∏–ø–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ‚Äî –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö. 
# –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–∫–∏–µ –ø–æ–ª—è:
# - `order_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞.
# - `user_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
# - `created_dt_msk` ‚Äî –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è).
# - `created_ts_msk` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è).
# - `event_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã events.
# - `cinema_circuit` ‚Äî —Å–µ—Ç—å –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–æ–≤. –ï—Å–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ, —Ç–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ '–Ω–µ—Ç'.
# - `age_limit` ‚Äî –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.
# - `currency_code` ‚Äî –≤–∞–ª—é—Ç–∞ –æ–ø–ª–∞—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä rub –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Ä—É–±–ª–µ–π.
# - `device_type_canonical` ‚Äî —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª –æ—Ñ–æ—Ä–º–ª–µ–Ω –∑–∞–∫–∞–∑, –Ω–∞–ø—Ä–∏–º–µ—Ä mobile –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, desktop –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö.
# - `revenue` ‚Äî –≤—ã—Ä—É—á–∫–∞ –æ—Ç –∑–∞–∫–∞–∑–∞.
# - `service_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∏–ª–µ—Ç–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
# - `tickets_count` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤.
# - `total` ‚Äî –æ–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞.
# - –í –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫–∂–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω —Å—Ç–æ–ª–±–µ—Ü `days_since_prev` —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–Ω–µ–π —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–µ –±—ã–ª–æ, —Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–ø—É—Å–∫.
# 
# –í—Ç–æ—Ä–æ–π –¥–∞—Ç–∞—Å–µ—Ç `final_tickets_events_df` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±—ã—Ç–∏—è—Ö, –≤–∫–ª—é—á–∞—è –≥–æ—Ä–æ–¥ –∏ —Ä–µ–≥–∏–æ–Ω —Å–æ–±—ã—Ç–∏—è, –∞ —Ç–∞–∫–∂–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–æ—â–∞–¥–∫–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è. –ò–∑ –¥–∞–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–∏–ª–∏ —Ñ–∏–ª—å–º—ã, –≤–µ–¥—å, –∫–∞–∫ –±—ã–ª–æ –≤–∏–¥–Ω–æ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ, —Å–æ–±—ã—Ç–∏–π —Ç–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ. –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–∫–∏–µ –ø–æ–ª—è:
# - `event_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.
# - `event_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è. –ê–Ω–∞–ª–æ–≥ –ø–æ–ª—è event_name_code –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
# - `event_type_description` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∏–ø–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.
# - `event_type_main` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è: —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –∫–æ–Ω—Ü–µ—Ä—Ç –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.
# - `organizers` ‚Äî –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.
# - `region_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞.
# - `city_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞.
# - `venue_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–ª–æ—â–∞–¥–∫–∏.
# - `venue_name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–æ—â–∞–¥–∫–∏.
# - `venue_address` ‚Äî –∞–¥—Ä–µ—Å –ø–ª–æ—â–∞–¥–∫–∏.
# 
# –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –≤—ã—Ä—É—á–∫–∞ –æ—Ç –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –¥–≤—É—Ö –≤–∞–ª—é—Ç–∞—Ö ‚Äî —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Ä—É–±–ª—è—Ö –∏ –∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏—Ö —Ç–µ–Ω–≥–µ. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–æ –±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∫ –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫ —Ä–æ—Å—Å–∏–π—Å–∫–∏–º —Ä—É–±–ª—è–º. –î–ª—è —ç—Ç–æ–≥–æ –≤ –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç `final_tickets_tenge_df.csv` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫—É—Ä—Å–µ —Ç–µ–Ω–≥–µ –∫ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É —Ä—É–±–ª—é –∑–∞ 2024 –≥–æ–¥. –ó–Ω–∞—á–µ–Ω–∏—è –≤ —Ä—É–±–ª—è—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–ª—è 100 —Ç–µ–Ω–≥–µ. –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–∫–∏–µ –ø–æ–ª—è:
# - `nominal` ‚Äî –Ω–æ–º–∏–Ω–∞–ª (100 —Ç–µ–Ω–≥–µ).
# - `data` ‚Äî –¥–∞—Ç–∞.
# - `curs` ‚Äî –∫—É—Ä—Å —Ç–µ–Ω–≥–µ –∫ —Ä—É–±–ª—é.
# - `cdx` ‚Äî –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã (kzt).
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∞–ª—é—Ç—ã.

# ## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–µ–∫—Ç–∞
# –ü—Ä–æ–≤–µ–¥–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –¥–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–æ–ª–ª–µ–≥. –í —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —Å–æ–±—ã—Ç–∏–π, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É —Å –∑–∞–∫–∞–∑–∞ –∏ –ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –≤ —Ä—É–±–ª—è—Ö, –∞ —Ç–∞–∫–∂–µ –∏–∑—É—á–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –ø–µ—Ä–∏–æ–¥–∞–º –≤—Ä–µ–º–µ–Ω–∏.

# ## –ü–ª–∞–Ω
# - –®–∞–≥ 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –Ω–∏–º–∏
# - –®–∞–≥ 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Ö –∫ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é
# - –®–∞–≥ 3. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö:
#   - –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º –∏ –∏—Ö —Å–µ–∑–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
#   - –û—Å–µ–Ω–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
#   - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã
# - –®–∞–≥ 4. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
# - –®–∞–≥ 5. –û–±—â–∏–π –≤—ã–≤–æ–¥ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# 

# ## 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –Ω–∏–º–∏
# 
# –ó–∞–≥—Ä—É–∑–∏–º –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:

# In[1]:


# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
from scipy.stats import levene
from scipy.stats import mannwhitneyu


# In[2]:


#–°—Ñ–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã:
final_tickets_orders_df = pd.read_csv('/datasets/final_tickets_orders_df.csv')
final_tickets_events_df = pd.read_csv('/datasets/final_tickets_events_df.csv')
final_tickets_tenge_df = pd.read_csv('/datasets/final_tickets_tenge_df.csv')


# <div class="alert alert-info">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ <a class="tocSkip"> </h2>
# 
# –ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ —Å–æ–≤–µ—Ç—ã! –ù–µ –ø–æ–º–Ω—é, —á—Ç–æ–±—ã –≤ —Å–ø—Ä–∏–Ω—Ç–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–ª–∞—Å—å —ç—Ç–∞ —Ç–µ–º–∞, –∞ –≤–µ–¥—å —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã —É–∂–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫ –æ—à–∏–±–∫–∞–º –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
# </div>

# In[3]:


#–û—Ç–æ–±—Ä–∞–∑–∏–º –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:
display(final_tickets_orders_df.head())
display(final_tickets_events_df.head())
display(final_tickets_tenge_df.head())


# In[4]:


#–ü—Ä–æ–≤–µ–¥–µ–º –±–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞:
final_tickets_orders_df.info()
final_tickets_events_df.info()
final_tickets_tenge_df.info()


# - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–ø–∏—Å–∞–Ω–∏—é;
# - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö, –∫—Ä–æ–º–µ —Å—Ç–æ–ª–±—Ü–∞ `days_since_prev` –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `final_tickets_orders_df` –æ–¥–Ω–∞–∫–æ, –∫–∞–∫ —Å–ª–µ–¥—É–µ—Ç –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è - —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–µ –±—ã–ª–æ, —Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–ø—É—Å–∫;
# - —Å—Ç–æ–ª–±—Ü—ã `created_dt_msk` –∏ `created_ts_msk` –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ `final_tickets_orders_df` —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –¥–∞—Ç–∞–º–∏. –ò—Ö —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–≤–µ–∑—Ç–∏ –∫ —Ç–∏–ø—É datetime64.

# In[5]:


#–ü—Ä–∏–≤–µ–¥–µ–º —Å—Ç–æ–ª–±—Ü—ã —Å –¥–∞—Ç–∞–º–∏ –∫ —Ç–∏–ø—É datetime
final_tickets_orders_df['created_dt_msk'] = pd.to_datetime(final_tickets_orders_df['created_dt_msk'])
final_tickets_orders_df['created_ts_msk'] = pd.to_datetime(final_tickets_orders_df['created_ts_msk'])
final_tickets_tenge_df['data'] = pd.to_datetime(final_tickets_tenge_df['data'])
#–ü—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
final_tickets_orders_df.info()
final_tickets_tenge_df.info()


# - –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ (–∫—Ä–æ–º–µ –≤ —Å—Ç–æ–ª–±—Ü–∞ `days_since_prev`):

# In[6]:


print(final_tickets_orders_df.isnull().sum())
print(final_tickets_events_df.isnull().sum())
print(final_tickets_tenge_df.isnull().sum())


# - –ü—Ä–æ–ø—É—Å–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–æ–ª–±—Ü–µ `days_since_prev`

# - –ò–∑—É—á–∏–º —Å—Ç–æ–ª–±—Ü—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

# In[7]:


# –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã
merged_df = final_tickets_orders_df.merge(final_tickets_events_df, on='event_id', how='left')

# –°–æ–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫—É—Ä—Å–µ —Å –æ—Å–Ω–æ–≤–Ω—ã–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–º
merged_df = merged_df.merge(final_tickets_tenge_df[['data', 'curs']], left_on='created_dt_msk', right_on='data', how='left')
# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º kzt –≤ —Ä—É–±–ª–∏
merged_df['revenue_rub'] = merged_df.apply(lambda row: row['revenue'] * row['curs'] / 100 if row['currency_code'] == 'kzt' else row['revenue'], axis=1)
display(merged_df)


# - –ü—Ä–æ–≤–µ—Ä–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏:

# In[8]:


unique_values_1 = merged_df['device_type_canonical'].unique()
print(unique_values_1)
unique_values_2 = merged_df['cinema_circuit'].unique()
print(unique_values_2)
unique_values_3 = merged_df['age_limit'].unique()
print(unique_values_3)
unique_values_4 = merged_df['currency_code'].unique()
print(unique_values_4)
unique_values_5 = merged_df['service_name'].unique()
print(unique_values_5)
unique_values_6 = merged_df['event_type_description'].unique()
print(unique_values_6)
unique_values_7 = merged_df['event_type_main'].unique()
print(unique_values_7)
unique_values_7 = merged_df['region_name'].unique()
print(unique_values_7)


# - 'cinema_circuit' - —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ "–Ω–µ—Ç", –∫–æ—Ç–æ—Ä–æ–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫—Ä—ã–ª–∏ –∑–∞–≥–ª—É—à–∫–æ–π.
# - 'event_type_description' - —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ "—Å–æ–±—ã—Ç–∏–µ", –∫–æ—Ç–æ—Ä–æ–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫—Ä—ã–ª–∏ –∑–∞–≥–ª—É—à–∫–æ–π.
# - 'event_type_main' –∏ 'region_name' - —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–ø—É—Å–∫ "nan"

# In[9]:


#–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö 'event_type_main' –∏ 'region_name'
print(merged_df[['event_type_main', 'region_name']].isna().sum())


# In[10]:


#–£–¥–∞–ª–∏–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏
merged_df = merged_df.dropna(subset=['event_type_main', 'region_name'])
#–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:
print(merged_df.isna().sum())


# - –ü—Ä–æ–ø—É—Å–∫–∏ —É–¥–∞–ª–µ–Ω—ã. –û—Å—Ç–∞–ª–∏—Å—å –ø—Ä–æ–ø—É—Å–∫–∏ —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–æ–ª–±—Ü–µ days_since_prev, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –Ω–µ –±—É–¥–µ–º —Ç—Ä–æ–≥–∞—Ç—å, —Ç.–∫. –∏—Ö –Ω–∞–ª–∏—á–∏–µ - –æ–ø—Ä–∞–≤–¥–∞–Ω–æ.

# ### –ò–∑—É—á–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å—Ç–æ–ª–±—Ü–∞–º - `revenue` –∏ `tickets_count`.
# - –ù–∞—á–Ω–µ–º —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –ü–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –¥–≤–µ –≤–∞–ª—é—Ç—ã - —Ä–∞–∑–¥–µ–ª–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é rub –∏ kzt –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:

# In[11]:


df_rub = merged_df[merged_df['currency_code'] == 'rub']
df_kzt = merged_df[merged_df['currency_code'] == 'kzt']


# - –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ df_rub['revenue']

# In[12]:


df_rub['revenue'].describe()


# –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:
# - –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ (mean): 548.01. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –ø–æ –≤—Å–µ–º –∑–∞–∫–∞–∑–∞–º.
# - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (std): 871.75. –í—ã—Å–æ–∫–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—Ä—É—á–∫–∏ —Å–∏–ª—å–Ω–æ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
# - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (min): -90.76. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫—É –≤ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç—ã —Å—Ä–µ–¥—Å—Ç–≤.
# - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (max): 81 174.54. –≠—Ç–æ –∫—Ä–∞–π–Ω–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–æ—Å–æ–º –∏ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

# In[13]:


#–ü—Ä–æ–≤–µ—Ä–∏–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
df_rub_sub_zero = df_rub[df_rub['revenue'] <0 ]
display(df_rub_sub_zero.head())


# - –í –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –í–µ—Ä–æ—è—Ç–Ω–æ, —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –≤–æ–∑–≤—Ä–∞—Ç–∞–º–∏ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.

# - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—ã–±—Ä–æ—Å—ã. –ù–∞—á–Ω–µ–º —Å –ø–æ–∏—Å–∫–∞ 99-–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è:

# In[14]:


ninety_ninth_percentile_rub = df_rub['revenue'].quantile(0.99)
print(ninety_ninth_percentile_rub)


# In[15]:


#–ù–∞–π–¥–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—à–µ 99-–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è:
pd.set_option('display.max_columns', None)
more_then_ninety_ninth_percentile = df_rub[df_rub['revenue'] > 2570.8]
display(more_then_ninety_ninth_percentile.head())


# - –í–µ—Ä–æ—è—Ç–Ω–æ, —á–µ–º –≤—ã—à–µ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞, —Ç–µ–º –±–æ–ª—å—à–µ –≤—ã—Ä—É—á–∫–∞. –≠—Ç–æ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—ã—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏.

# - –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ df_kzt['revenue']

# In[16]:


df_kzt['revenue'].describe()


# –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:
# - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: 4 916.75, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–±—Ä–æ—Å –≤—ã—Ä—É—á–∫–∏ –≤–æ–∫—Ä—É–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
# - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (max): 26 425.86. –≠—Ç–æ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–æ—Å–æ–º –∏ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

# In[17]:


ninety_ninth_percentile_kzt = df_kzt['revenue'].quantile(0.99)
print(ninety_ninth_percentile_kzt)


# In[18]:


more_then_ninety_ninth_percentile_kzt = df_kzt[df_kzt['revenue'] > 17617.24]
display(more_then_ninety_ninth_percentile_kzt.head())


# - –í—ã–≤–æ–¥, –∫–∞–∫ –∏ –ø–æ df_rub - —á–µ–º –≤—ã—à–µ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞, —Ç–µ–º –±–æ–ª—å—à–µ –≤—ã—Ä—É—á–∫–∞. –≠—Ç–æ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—ã—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏.

# - –ü—Ä–æ–≤–µ–¥–µ–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Å—Ç–æ–ª–±—Ü—É `tickets_count`

# In[19]:


df_rub['tickets_count'].describe()


# –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã:
# - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: 1.17, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –≤–æ–∫—Ä—É–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
# - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–∫–∞–∑–µ: 57, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.

# In[20]:


ninety_ninth_percentile_tickets_rub = df_rub['tickets_count'].quantile(0.99)
print(ninety_ninth_percentile_tickets_rub)


# In[21]:


more_then_ninety_ninth_percentile_tickets_rub  = df_rub[df_rub['tickets_count'] > 6]
display(more_then_ninety_ninth_percentile_tickets_rub.head())


# - –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ –Ω–∞–ª–∏—á–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –±–∏–ª–µ—Ç–æ–≤ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ, —Ç.–∫. –Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–æ, —á—Ç–æ –±–∏–ª–µ—Ç—ã –ø–æ–∫—É–ø–∞–ª–∞ —Ü–µ–ª–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–≤–æ–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

# In[22]:


df_kzt['tickets_count'].describe()


# –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ –≤—ã—Å–æ–∫–æ–µ, —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω–æ –º–µ–¥–∏–∞–Ω–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–¥–∞–ª–µ–∫–æ –æ—Ç 75-–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è.

# - –ü–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–∑–º–∞—Ö–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è rub –∏ kzt - –Ω–∞—á–Ω–µ–º —Å–æ —Å—Ç–æ–ª–±—Ü–∞ `revenue`

# In[23]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 5))

# –°—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É —Å –ø–æ–º–æ—â—å—é pandas —á–µ—Ä–µ–∑ plot(kind='hist')
df_rub['revenue'].plot(
                kind='hist', # –¢–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞ - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
                bins=50, # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–∑–∏–Ω - –≤—Å–µ–≥–æ 50
                alpha=0.75,
                edgecolor='black',
                rot=0, # –ì—Ä–∞–¥—É—Å –≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ –ø–æ –æ—Å–∏ –•
)

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏ –≤ rub')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
# –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç–∫—É –≥—Ä–∞—Ñ–∏–∫–∞
plt.grid()

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# In[24]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 3))

# –°—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞–∑–º–∞—Ö–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ revenue
df_rub.boxplot(column='revenue', vert=False)

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏ –æ—Å–∏
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏ –≤ rub')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# –î–∞–Ω–Ω—ã–µ —Å —à–∏—Ä–æ–∫–∏–º —Ä–∞–∑–±—Ä–æ—Å–æ–º –∏ ¬´—Ö–≤–æ—Å—Ç–æ–º¬ª –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã. –¢–∞–∫–∏–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –æ—Ç–Ω–µ—Å—Ç–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º. –û–¥–Ω–∞–∫–æ —Å–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–µ –≤—ã–≥–ª—è–¥—è—Ç –æ—à–∏–±–∫–æ–π, –∏ —Ç–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–µ–∫–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç –±–∏–ª–µ—Ç—ã –Ω–∞ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –ª–∏–±–æ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–æ–¥—è—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π, –ø–æ–ª—É—á–∞—é—Ç –¥–µ–Ω—å–≥–∏ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –∑–∞–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Ç–æ –∏–ª–∏ –∏–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ). 

# In[25]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 5))

# –°—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É —Å –ø–æ–º–æ—â—å—é pandas —á–µ—Ä–µ–∑ plot(kind='hist')
df_kzt['revenue'].plot(
                kind='hist', # –¢–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞ - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
                bins=50, # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–∑–∏–Ω - –≤—Å–µ–≥–æ 50
                alpha=0.75,
                edgecolor='black',
                rot=0, # –ì—Ä–∞–¥—É—Å –≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ –ø–æ –æ—Å–∏ –•
)

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏ –≤ kzt')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
# –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç–∫—É –≥—Ä–∞—Ñ–∏–∫–∞
plt.grid()

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# In[26]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 3))

# –°—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞–∑–º–∞—Ö–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ revenue
df_kzt.boxplot(column='revenue', vert=False)

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏ –æ—Å–∏
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—Ä—É—á–∫–∏ –≤ kzt')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# - –ü–æ kzt –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –Ω–æ —Ç–∞–∫–∂–µ —Å —Ö–≤–æ—Å—Ç–æ–º –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã. –í—ã–±—Ä–æ—Å–æ–≤ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ(–Ω–æ –∏ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ, —è –Ω–µ —Å—á–∏—Ç–∞—é, —á—Ç–æ —ç—Ç–æ –≤—ã–±—Ä–æ—Å—ã –ø–æ —Ç–æ–π –∂–µ –ª–æ–≥–∏–∫–µ, —á—Ç–æ –∏ –ø–æ –∑–∞–∫–∞–∑–∞–º –≤ —Ä—É–±–ª—è—Ö –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º –≤—ã—à–µ), –Ω–æ –∏ –∑–∞–∫–∞–∑–æ–≤ –≤ —Ç–µ–Ω–≥–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫–∞–∑–æ–≤ –≤ —Ä—É–±–ª—è—Ö.

# - –¢–µ–ø–µ—Ä—å —Å–¥–µ–ª–∞–µ–º —Ç–µ –∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ `tickets_count`

# In[27]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 5))

# –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
ticket_counts = df_rub['tickets_count'].value_counts().sort_index()

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.bar(ticket_counts.index, ticket_counts.values, edgecolor='black')

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –≤ rub')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.grid()

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# In[28]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 3))

# –°—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞–∑–º–∞—Ö–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ revenue
df_rub.boxplot(column='tickets_count', vert=False)

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏ –æ—Å–∏
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –≤ rub')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# - –ø–æ —Å—Ç–æ–ª–±—Ü—É `tickets_count` –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—ã–±—Ä–æ—Å—ã –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–∑–º–∞—Ö–∞. –¢–∞–∫–∏–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –æ—Ç–Ω–µ—Å—Ç–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º, –æ–¥–Ω–∞–∫–æ —Å–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è - –Ω–µ –≤—ã–≥–ª—è–¥—è—Ç –æ—à–∏–±–∫–æ–π, –∏ —Ç–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–µ–∫–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç –±–∏–ª–µ—Ç—ã –Ω–∞ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –ª–∏–±–æ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–æ–¥—è—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π, –ø–æ–ª—É—á–∞—é—Ç –¥–µ–Ω—å–≥–∏ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –∑–∞–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Ç–æ –∏–ª–∏ –∏–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ). 

# In[29]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 5))

# –°—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É —Å –ø–æ–º–æ—â—å—é pandas —á–µ—Ä–µ–∑ plot(kind='hist')
df_kzt['tickets_count'].plot(
                kind='hist', # –¢–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞ - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
                bins=50, # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–∑–∏–Ω - –≤—Å–µ–≥–æ 50
                alpha=0.75,
                edgecolor='black',
                rot=0, # –ì—Ä–∞–¥—É—Å –≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ –ø–æ –æ—Å–∏ –•
)

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤ kzt')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
# –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç–∫—É –≥—Ä–∞—Ñ–∏–∫–∞
plt.grid()

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# In[30]:


# –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ matplotlib –∏ –∑–∞–¥–∞—ë–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä
plt.figure(figsize=(15, 3))

# –°—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞–∑–º–∞—Ö–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ revenue
df_kzt.boxplot(column='tickets_count', vert=False)

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏ –æ—Å–∏
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –≤ kzt')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')

# –í—ã–≤–æ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()


# - –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–∏–ª–µ—Ç–æ–≤ –ø–æ –∑–∞–∫–∞–∑–∞–º –≤ —Ç–µ–Ω–≥–µ –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π

# ### –í—ã–≤–æ–¥ –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π:
# - –° –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —è –Ω–µ —Å—á–∏—Ç–∞—é –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ 99-–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è –≤—ã–±—Ä–æ—Å–∞–º–∏, —Ç.–∫. —Ç–∞–∫–∏–µ –∫—Ä—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å. –ù–æ –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–∞–∫–∏–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –∏—Å–∫–∞–∑–∏—Ç—å –æ–±—â–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö - –ø—Ä–∏–Ω–∏–º–∞—é —Ä–µ—à–µ–Ω–∏–µ –æ—Ç –Ω–∏—Ö –∏–∑–±–∞–≤–∏—Ç—å—Å—è.

# In[31]:


df_rub = df_rub[(df_rub['revenue'] <= ninety_ninth_percentile_rub) & (df_rub['revenue'] > 0) & (df_rub['tickets_count'] <= ninety_ninth_percentile_tickets_rub) & (df_rub['tickets_count'] > 0)]
df_kzt= df_kzt[(df_kzt['revenue'] <= ninety_ninth_percentile_kzt) & (df_kzt['revenue'] > 0) & (df_kzt['tickets_count'] > 0)]
final_df = pd.concat([df_rub, df_kzt], ignore_index=True)
display(final_df.head())


# ### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

# In[32]:


#–ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
duplicates = final_df[final_df.duplicated(keep=False)]
print(duplicates)


# - –Ø–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

# In[33]:


#–ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –≤—Å–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º, –∫—Ä–æ–º–µ order_id
columns_to_check = final_df.columns.drop('order_id')
special_duplicates = final_df[final_df.duplicated(subset=columns_to_check, keep=False)]
print(special_duplicates.shape[0])
display(special_duplicates.head())


# - –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 56 –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤. –£–¥–∞–ª–∏–º –∏—Ö:

# In[34]:


final_df = final_df.drop_duplicates(subset=columns_to_check, keep='first')
# –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–¥–∞–ª–µ–Ω–∏—è:
columns_to_check = final_df.columns.drop('order_id')
special_duplicates = final_df[final_df.duplicated(subset=columns_to_check, keep=False)]
print(special_duplicates.shape[0])
display(special_duplicates.head())


# - –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ. –ï—â–µ —Ä–∞–∑ –æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Ç–æ–≥–æ–≤–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ

# In[35]:


final_df.info()


# - –°–Ω–∏–∑–∏–º —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

# In[36]:


# –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å
columns_to_convert = ['order_id', 'event_id', 'age_limit', 'city_id', 'tickets_count', 'venue_id']

# –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ –≤—Å–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º
final_df[columns_to_convert] = final_df[columns_to_convert].apply(pd.to_numeric, downcast='integer')
final_df.info()


# - –°–æ–∑–¥–∞–¥–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤:
#   - one_ticket_revenue_rub ‚Äî —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –≤—ã—Ä—É—á–∫—É —Å –ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ.
#   - month ‚Äî –≤—ã–¥–µ–ª–∏–º –º–µ—Å—è—Ü –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü.
#   - season ‚Äî —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–æ–ª–±–µ—Ü —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è —Ç–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–∞–∫: '–ª–µ—Ç–æ', '–æ—Å–µ–Ω—å', '–∑–∏–º–∞', '–≤–µ—Å–Ω–∞'.

# In[37]:


#–í—ã—á–∏—Å–ª—è–µ–º –≤—ã—Ä—É—á–∫—É —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ø–æ –º–µ—Ä–æ–ø–∏—è—Ç–∏—é
final_df['one_ticket_revenue_rub'] = final_df['revenue_rub'] / final_df['tickets_count']
display(final_df.head())


# In[38]:


#–°–æ–∑–¥–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü —Å –º–µ—Å—è—Ü–µ–º, –≤—ã—Ç—è–≥–∏–≤–∞—è –º–µ—Å—è—Ü –∏–∑ –¥–∞—Ç—ã –≤ —Å—Ç–æ–ª–±—Ü–µ created_dt_msk
final_df['month'] = final_df['created_dt_msk'].dt.month
final_df['month'] = pd.to_numeric(final_df['month'], downcast='integer')
display(final_df.head())


# In[39]:


#–°—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ –º–µ—Å—è—Ü–∞–º
def determine_season(month):
    if month in [12, 1, 2]:
        return '–∑–∏–º–∞'
    elif month in [3, 4, 5]:
        return '–≤–µ—Å–Ω–∞'
    elif month in [6, 7, 8]:
        return '–ª–µ—Ç–æ'
    else:
        return '–æ—Å–µ–Ω—å'

final_df['season'] = final_df['created_dt_msk'].dt.month.apply(determine_season)
display(final_df.head())


# In[40]:


#–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∏—Ç–æ–≥–æ–≤—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
final_df.info()


# ### –í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
# - –û–±—ä–µ–¥–∏–Ω–∏–ª–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –≤ –æ–¥–∏–Ω
# - –£–¥–∞–ª–∏–ª–∏ –≤—ã–±—Ä–æ—Å—ã, –æ—Å—Ç–∞–≤–∏–≤ –¥–∞–Ω–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö revenue –∏ tickets_count –±–æ–ª—å—à–µ 0 –ø–æ 99–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å
# - –£–¥–∞–ª–∏–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã
# - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —É–º–µ–Ω—å—à–∏–ª–∏ —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# - –°–æ–∑–¥–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤:
#   - revenue_rub - —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤–∞–ª—é—Ç—É –∏–∑ —Ç–µ–Ω–≥–µ –≤ —Ä—É–±–ª–∏ –∏ –æ—Å—Ç–∞–≤–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª–∏ –≤ —Ä—É–±–ª—è—Ö
#   - one_ticket_revenue_rub - –≤—ã—Ä—É—á–∫–∞ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º
#   - month - –º–µ—Å—è—Ü –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
#   - season - —Å–µ–∑–æ–Ω –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
# - –ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–π –æ—Å—Ç–∞–≤–∏–ª–∏ 281700 —Å—Ç—Ä–æ–∫.

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# ## –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º –∏ –∏—Ö —Å–µ–∑–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

# ### –ò–∑—É—á–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Å–≤—è–∑–∏ —Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é. 

# - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –Ω–∞–π–¥–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

# In[41]:


grouped = final_df.groupby('month').agg({'order_id': 'count'}, ascending = False).reset_index()
display(grouped)


# In[42]:


plt.figure(figsize=(15, 5))  # –†–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã
plt.bar(grouped['month'], grouped['order_id'])
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()


# - –ö–∞–∫ –≤–∏–¥–∏–º - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º –º–µ—Å—è—Ü–µ–º

# - –î–ª—è –æ—Å–µ–Ω–Ω–µ–≥–æ –∏ –ª–µ—Ç–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–æ–≤ —Å—Ä–∞–≤–Ω–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –±–∏–ª–µ—Ç–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: —Ç–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É.

# In[43]:


final_df_summer = final_df[final_df['season'] == '–ª–µ—Ç–æ']
grouped_by_event_type_summer = final_df_summer.groupby('event_type_main').agg({'order_id': 'count'}) / final_df_summer['order_id'].count() 
grouped_by_event_type_summer.sort_values(by='event_type_main', ascending=True, inplace=True)
display(grouped_by_event_type_summer)


# In[44]:


final_df_autumn = final_df[final_df['season'] == '–æ—Å–µ–Ω—å']
grouped_by_event_type_autumn = final_df_autumn.groupby('event_type_main').agg({'order_id': 'count'}) / final_df_autumn['order_id'].count()
grouped_by_event_type_autumn.sort_values(by='event_type_main', ascending=True, inplace=True)
display(grouped_by_event_type_autumn)


# In[45]:


grouped_by_device_type_summer = final_df_summer.groupby('device_type_canonical').agg({'order_id': 'count'}) / final_df_summer['order_id'].count()
grouped_by_device_type_summer.sort_values(by='order_id', ascending=True, inplace=True)
grouped_by_device_type_summer.sort_values(by='device_type_canonical', ascending=True, inplace=True)
display(grouped_by_device_type_summer)


# In[46]:


grouped_by_device_type_autumn = final_df_autumn.groupby('device_type_canonical').agg({'order_id': 'count'}) / final_df_autumn['order_id'].count() 
grouped_by_device_type_autumn.sort_values(by='order_id', ascending=True, inplace=True)
grouped_by_device_type_autumn.sort_values(by='device_type_canonical', ascending=True, inplace=True)
display(grouped_by_device_type_autumn)


# In[47]:


grouped_by_age_limit_summer = final_df_summer.groupby('age_limit').agg({'order_id': 'count'}) / final_df_summer['order_id'].count() 
grouped_by_age_limit_summer.sort_values(by='order_id', ascending=True, inplace=True)
grouped_by_age_limit_summer.sort_values(by='age_limit', ascending=True, inplace=True)
display(grouped_by_age_limit_summer)


# In[48]:


grouped_by_age_limit_autumn = final_df_autumn.groupby('age_limit').agg({'order_id': 'count'}) / final_df_autumn['order_id'].count() 
grouped_by_age_limit_autumn.sort_values(by='order_id', ascending=True, inplace=True)
grouped_by_age_limit_autumn.sort_values(by='age_limit', ascending=True, inplace=True)
display(grouped_by_age_limit_autumn)


# - –ü–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

# In[49]:


# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.figure(figsize=(15, 5))  # –†–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã
ax = plt.gca()  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π axes

# –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
bar_width = 0.2
# –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π —Ç.–∫. –ª–µ—Ç–æ–º –∏ –æ—Å–µ–Ω—å—é –±—ã–ª–æ —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π - –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø—Ä–∏—Å—É—Ç—Å–≤–æ–≤–∞–ª–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –∫–∞–∂–¥–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
all_events = grouped_by_event_type_summer.index.union(grouped_by_event_type_autumn.index)

# –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω—É–ª—è–º–∏
grouped_by_event_type_summer = grouped_by_event_type_summer.reindex(all_events, fill_value=0)
display(grouped_by_event_type_summer)
grouped_by_event_type_autumn = grouped_by_event_type_autumn.reindex(all_events, fill_value=0)
display(grouped_by_event_type_autumn)
data_to_plot = pd.concat([grouped_by_event_type_summer, grouped_by_event_type_autumn], keys=['–õ–µ—Ç–æ', '–û—Å–µ–Ω—å'])


# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ª–µ—Ç–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–õ–µ—Ç–æ'].plot(kind='bar', color='orange', ax=ax, label='–õ–µ—Ç–æ', width=bar_width, position=0)

# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –æ—Å–µ–Ω–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–û—Å–µ–Ω—å'].plot(kind='bar', color='skyblue', ax=ax, label='–û—Å–µ–Ω—å', width=bar_width, position=1)

plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ª–µ—Ç–æ–º –∏ –æ—Å–µ–Ω—å—é')
plt.xlabel('–¢–∏–ø —Å–æ–±—ã—Ç–∏—è')
plt.ylabel('–î–æ–ª—è –∑–∞–∫–∞–∑–æ–≤')
plt.legend(title='–°–µ–∑–æ–Ω')
# –ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
plt.legend(handles=[mpatches.Patch(color='orange', label='–õ–µ—Ç–æ'), mpatches.Patch(color='skyblue', label='–û—Å–µ–Ω—å')], title='–°–µ–∑–æ–Ω')

plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()


# In[50]:


# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.figure(figsize=(15, 5))  # –†–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã
ax = plt.gca()  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π axes

# –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
bar_width = 0.2
data_to_plot = pd.concat([grouped_by_device_type_summer, grouped_by_device_type_autumn], keys=['–õ–µ—Ç–æ', '–û—Å–µ–Ω—å'])


# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ª–µ—Ç–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–õ–µ—Ç–æ'].plot(kind='bar', color='orange', ax=ax, label='–õ–µ—Ç–æ', width=bar_width, position=0)

# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –æ—Å–µ–Ω–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–û—Å–µ–Ω—å'].plot(kind='bar', color='skyblue', ax=ax, label='–û—Å–µ–Ω—å', width=bar_width, position=1)

plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–∏–ø—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞')
plt.xlabel('–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞')
plt.ylabel('–î–æ–ª—è –∑–∞–∫–∞–∑–æ–≤')
plt.legend(title='–°–µ–∑–æ–Ω')
# –ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
plt.legend(handles=[mpatches.Patch(color='orange', label='–õ–µ—Ç–æ'), mpatches.Patch(color='skyblue', label='–û—Å–µ–Ω—å')], title='–°–µ–∑–æ–Ω')

plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()


# In[51]:


# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.figure(figsize=(15, 5))  # –†–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä—ã
ax = plt.gca()  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π axes

# –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
bar_width = 0.2
data_to_plot = pd.concat([grouped_by_age_limit_summer, grouped_by_age_limit_autumn], keys=['–õ–µ—Ç–æ', '–û—Å–µ–Ω—å'])


# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ª–µ—Ç–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–õ–µ—Ç–æ'].plot(kind='bar', color='orange', ax=ax, label='–õ–µ—Ç–æ', width=bar_width, position=0)

# –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –æ—Å–µ–Ω–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
data_to_plot.loc['–û—Å–µ–Ω—å'].plot(kind='bar', color='skyblue', ax=ax, label='–û—Å–µ–Ω—å', width=bar_width, position=1)

plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.xlabel('–í–æ–∑—Ä–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
plt.ylabel('–î–æ–ª—è –∑–∞–∫–∞–∑–æ–≤')
plt.legend(title='–°–µ–∑–æ–Ω')
# –ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
plt.legend(handles=[mpatches.Patch(color='orange', label='–õ–µ—Ç–æ'), mpatches.Patch(color='skyblue', label='–û—Å–µ–Ω—å')], title='–°–µ–∑–æ–Ω')

plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()


# ### –ò–∑—É—á–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ —Å –ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ª–µ—Ç–æ–º –∏ –æ—Å–µ–Ω—å—é.

# In[52]:


#–°—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ª–µ—Ç–æ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:
grouped_by_event_type_summer_revenue_per_ticket = final_df_summer.groupby('event_type_main').agg({'revenue_rub': 'sum', 'tickets_count':'sum'})
grouped_by_event_type_summer_revenue_per_ticket = grouped_by_event_type_summer_revenue_per_ticket['revenue_rub']/grouped_by_event_type_summer_revenue_per_ticket['tickets_count']
display(grouped_by_event_type_summer_revenue_per_ticket)


# In[53]:


#–°—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –æ—Å–µ–Ω—å—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:
grouped_by_event_type_autumn_revenue_per_ticket = final_df_autumn.groupby('event_type_main').agg({'revenue_rub': 'sum', 'tickets_count':'sum'})
grouped_by_event_type_autumn_revenue_per_ticket = grouped_by_event_type_autumn_revenue_per_ticket['revenue_rub']/grouped_by_event_type_autumn_revenue_per_ticket['tickets_count']
display(grouped_by_event_type_autumn_revenue_per_ticket)


# - –û–±—ä–µ–¥–∏–Ω–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –∏ –ø–æ—Å—á–∏—Ç–∞–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –≤ –≤—ã—Ä—É—á–∫–µ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ª–µ—Ç–æ–º –∏ –æ—Å–µ–Ω—å—é

# In[54]:


#–í—ã–¥–µ–ª–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –æ–±–æ–∏—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤
all_events_revenue_per_ticket_by_season = grouped_by_event_type_summer_revenue_per_ticket.index.union(grouped_by_event_type_autumn_revenue_per_ticket)
# –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö –Ω—É–ª—è–º–∏
grouped_by_event_type_summer_revenue_per_ticket = grouped_by_event_type_summer_revenue_per_ticket.reindex(all_events, fill_value=0)
display(grouped_by_event_type_summer_revenue_per_ticket)
grouped_by_event_type_autumn_revenue_per_ticket = grouped_by_event_type_autumn_revenue_per_ticket.reindex(all_events, fill_value=0)
display(grouped_by_event_type_autumn_revenue_per_ticket)
# –û–±—ä–µ–¥–∏–Ω—è–µ–º –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã
revenue_per_ticket_by_season = pd.concat([grouped_by_event_type_summer_revenue_per_ticket, grouped_by_event_type_autumn_revenue_per_ticket], axis=1, keys=['–õ–µ—Ç–æ', '–û—Å–µ–Ω—å'])
# –ü–æ—Å—á–∏—Ç–∞–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –≤ –≤—ã—Ä—É—á–∫–µ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ª–µ—Ç–æ–º –∏ –æ—Å–µ–Ω—å—é
revenue_per_ticket_by_season['delta_between_season'] = revenue_per_ticket_by_season.apply(lambda x: 100 if x['–õ–µ—Ç–æ'] == 0 else round(((x['–û—Å–µ–Ω—å'] / x['–õ–µ—Ç–æ']) * 100 - 100), 2), axis=1)
display(revenue_per_ticket_by_season)


# - –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

# In[55]:


plt.figure(figsize=(15, 5))
ax = revenue_per_ticket_by_season['delta_between_season'].plot(kind='bar')

# –ó–∞–¥–∞–µ–º —Ü–≤–µ—Ç–∞ –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–Ω–∏—è–º–∏
colors = ['green' if val > 0 else 'red' for val in revenue_per_ticket_by_season['delta_between_season']]
for bar, color in zip(ax.containers[0], colors):
    bar.set_color(color)

plt.title('–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –æ—Å–µ–Ω—å—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ª–µ—Ç–∞')
plt.xlabel('–¢–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è')
plt.ylabel('–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (%)')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.show()




# ### –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –ø–æ –¥–≤—É–º –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø—É–Ω–∫—Ç–∞–º:
# - –í—ã–¥–µ–ª–∏–º –Ω–∞–∏–±–æ–ª–µ–µ –æ—Ç–ª–∏—á–∞—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º –≥—Ä—É–ø–ø–∞–º –º–µ–∂–¥—É —Å–µ–∑–æ–Ω–∞–º–∏ –ª–µ—Ç–æ/–æ—Å–µ–Ω—å —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏:
#   - –¢–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:
#      - –ö–æ–Ω—Ü–µ—Ä—Ç—ã - –ª–µ—Ç–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –≤—ã—à–µ, —á–µ–º –æ—Å–µ–Ω—å—é - –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.44 –ª–µ—Ç–æ–º –ø—Ä–æ—Ç–∏–≤ 0.37 –æ—Å–µ–Ω—å—é
#      - –¢–µ–∞—Ç—Ä—ã - –æ—Å–µ–Ω—å—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–µ–∫—Ç–∞–∫–ª–µ–π –≤—ã—à–µ, —á–µ–º –æ—Å–µ–Ω—å—é - –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.25 –æ—Å–µ–Ω—å—é –ø—Ä–æ—Ç–∏–≤ 0.21 –ª–µ—Ç–æ–º
#      - –¢–∞–∫–∂–µ –µ—Å—Ç—å —Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ —Ç–∏–ø—É "–¥—Ä—É–≥–æ–µ", –Ω–æ –µ–≥–æ –Ω–µ –±—É–¥–µ–º –±—Ä–∞—Ç—å –≤ —Ä–∞—Å—á–µ—Ç, —Ç.–∫. –Ω–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –ø–æ–¥ "–¥—Ä—É–≥–æ–µ", —Ç.–∫. —ç—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –∑–∞–≥–ª—É—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ —Å—Ç—Ä–æ–∫–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è.
#   - –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ - –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –æ–±–æ–∏–º —Ç–∏–ø–∞–º (–∫–æ–º–ø—å—é—Ç–µ—Ä –∏ —Ç–µ–ª–µ—Ñ–æ–Ω) –º–µ–∂–¥—É —Å–µ–∑–æ–Ω–∞–º–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã.
#   - –í–æ–∑—Ä–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
#     - 18 –∏ 16 –ª–µ—Ç - –ª–µ—Ç–æ–º 18-—Ç–∏ –∏ 16-—Ç–∏ –ª–µ—Ç–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–∞–∑–º–µ—â–∞—é—Ç –±–æ–ª—å—à–µ –∑–∞–∫–∞–∑–æ–≤, —á–µ–º –æ—Å–µ–Ω—å—é:
#       - 18 - –ª–µ—Ç–æ–º 0.14, –æ—Å–µ–Ω—å—é 0.10
#       - 16 - –ª–µ—Ç–æ–º 0.28, –æ—Å–µ–Ω—å—é 0.26
#     - –¢–∞–∫–∂–µ –≤—ã—Å–æ–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ –≥—Ä—É–ø–ø–µ "0", –Ω–æ —ç—Ç—É –≥—Ä—É–ø–ø—É –Ω–µ –±—É–¥–µ–º –±—Ä–∞—Ç—å –≤ —Ä–∞—Å—á–µ—Ç, —Ç.–∫. –≤–µ—Ä–æ—è—Ç–Ω–æ, —á—Ç–æ —ç—Ç–æ –∑–∞–≥–ª—É—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ —Å—Ç—Ä–æ–∫–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ 0 –ª–µ—Ç —è–≤–Ω–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å.
# - –ü–æ 2-–º –∏–∑ 7-—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –≤ —Ä–∞–∑–º–µ—Ä–µ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–∏ –∑–∞ –æ–¥–∏–Ω –±–∏–ª–µ—Ç, –∞ –∏–º–µ–Ω–Ω–æ: –≤—ã—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç–µ–Ω–¥–∞–ø. –ü–æ –æ—Å—Ç–∞–ª—å–Ω—ã–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º –≤–∏–¥–∏–º —Å–Ω–∏–∂–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–∏ –∑–∞ –±–∏–ª–µ—Ç.

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:</b> –î–∏–Ω–∞–º–∏–∫–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–∫–∞–∑–æ–≤, –∞ —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã—Ä—É—á–∫–∏ –∏–∑—É—á–µ–Ω—ã.

# ## –û—Å–µ–Ω–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# ### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∏–Ω–∞–º–∏–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –¥–Ω—è–º –¥–ª—è:
# - –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤;
# - –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π DAU;
# - —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
# - —Å—Ä–µ–¥–Ω–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞.

# In[56]:


final_df_autumn['date'] = final_df_autumn['created_dt_msk']

# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –∏ –≤—ã—á–∏—Å–ª—è–µ–º –Ω—É–∂–Ω—ã–µ –Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏—è
final_df_autumn_per_days = final_df_autumn.groupby('date').agg({'order_id': 'count', 'user_id': 'nunique', 'revenue_rub':'sum', 'tickets_count':'sum'})

# –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
final_df_autumn_per_days['avg_count_orders_by_user'] = final_df_autumn_per_days['order_id'] / final_df_autumn_per_days['user_id']
final_df_autumn_per_days['avg_one_ticket_revenue'] = final_df_autumn_per_days['revenue_rub'] / final_df_autumn_per_days['tickets_count']
final_df_autumn_per_days['revenue_rub'] = final_df_autumn_per_days['revenue_rub'].round(2)
display(final_df_autumn_per_days)


# - –ü–æ—Å—Ç—Ä–æ–∏–º –ª–∏–Ω–µ–π–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ –¥–Ω—è–º –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é

# In[57]:


final_df_autumn_per_days = final_df_autumn_per_days.reset_index()
plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='order_id', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.grid()
plt.show()


# In[58]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='user_id', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.grid()
plt.show()


# In[59]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='revenue_rub', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–í—ã—Ä—É—á–∫–∞ (—Ä—É–±)')
plt.grid()
plt.show()


# In[60]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='tickets_count', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')
plt.grid()
plt.show() 


# In[61]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='avg_one_ticket_revenue', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–∏ –∑–∞ –æ–¥–∏–Ω –±–∏–ª–µ—Ç –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ –∑–∞ –æ–¥–∏–Ω –±–∏–ª–µ—Ç')
plt.grid()
plt.show() 


# In[62]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_days.plot(kind='line', y='avg_count_orders_by_user', x='date')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –¥–Ω—è–º')
plt.xlabel('–î–µ–Ω—å')
plt.ylabel('–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.grid()
plt.show()  


# ### –ò–∑—É—á–∏–º –Ω–µ–¥–µ–ª—å–Ω—É—é —Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å. –í—ã–¥–µ–ª–∏–º –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –±—É–¥–Ω–∏ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ.

# In[63]:


final_df_autumn['day_of_week'] = final_df_autumn['created_dt_msk'].dt.day_name() 
# –ü–µ—Ä–µ–∏–º–µ–Ω—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –¥–Ω—è –Ω–µ–¥–µ–ª–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫:
# –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
day_names_map = {
    'Monday': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
    'Tuesday': '–í—Ç–æ—Ä–Ω–∏–∫',
    'Wednesday': '–°—Ä–µ–¥–∞',
    'Thursday': '–ß–µ—Ç–≤–µ—Ä–≥',
    'Friday': '–ü—è—Ç–Ω–∏—Ü–∞',
    'Saturday': '–°—É–±–±–æ—Ç–∞',
    'Sunday': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
}

# –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
final_df_autumn['day_of_week'] = final_df_autumn['day_of_week'].map(day_names_map)
# –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ:
day_order = {
    '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫': 1,
    '–í—Ç–æ—Ä–Ω–∏–∫': 2,
    '–°—Ä–µ–¥–∞': 3,
    '–ß–µ—Ç–≤–µ—Ä–≥': 4,
    '–ü—è—Ç–Ω–∏—Ü–∞': 5,
    '–°—É–±–±–æ—Ç–∞': 6,
    '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ': 7
}

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –ø–æ —Å—Ç–æ–ª–±—Ü—É 'day_of_week' —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–æ–≤–∞—Ä—è
final_df_autumn = final_df_autumn.sort_values(by='day_of_week', key=lambda x: x.map(day_order))
# –î–æ–±–∞–≤–∏–º —Å—Ç–æ–ª–±–µ—Ü —Å —Ç–∏–ø–æ–º –¥–Ω—è –Ω–µ–¥–µ–ª–∏ (–±—É–¥–Ω–∏, –≤—ã—Ö–æ–¥–Ω—ã–µ)
final_df_autumn['day_type'] = final_df_autumn['day_of_week'].apply(lambda x: '–≤—ã—Ö–æ–¥–Ω—ã–µ' if x in ['–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'] else '–±—É–¥–Ω–∏')

# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –∏ –≤—ã—á–∏—Å–ª—è–µ–º –Ω—É–∂–Ω—ã–µ –Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏—è
final_df_autumn_per_day_of_week = final_df_autumn.groupby('day_type').agg({'order_id': 'count', 'user_id': 'nunique', 'revenue_rub':'sum', 'tickets_count':'sum'})

# –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞
final_df_autumn_per_day_of_week['avg_count_orders_by_user'] = final_df_autumn_per_day_of_week['order_id'] / final_df_autumn_per_day_of_week['user_id']
final_df_autumn_per_day_of_week['avg_one_ticket_revenue'] = final_df_autumn_per_day_of_week['revenue_rub'] / final_df_autumn_per_day_of_week['tickets_count']
final_df_autumn_per_day_of_week = final_df_autumn_per_day_of_week.reset_index()
display(final_df_autumn_per_day_of_week)


# - –ü–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏(–±—É–¥–Ω–∏/–≤—ã—Ö–æ–¥–Ω—ã–µ)

# In[64]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='order_id')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.grid(axis='y')
plt.show()


# In[65]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='user_id')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.grid(axis='y')
plt.show()


# In[66]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='revenue_rub')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞ –≤—ã—Ä—É—á–∫–∞ –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–í—ã—Ä—É—á–∫–∞')
plt.grid(axis='y')
plt.show()


# In[67]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='tickets_count')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ–≤ –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤')
plt.grid(axis='y')
plt.show()


# In[68]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='avg_count_orders_by_user')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.grid(axis='y')
plt.show()


# In[69]:


plt.figure(figsize=(15, 5))
final_df_autumn_per_day_of_week.plot(kind='bar', x='day_type', y='avg_one_ticket_revenue')
plt.title(f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–∏ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.xlabel('–¢–∏–ø –¥–Ω—è –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ —Å –±–∏–ª–µ—Ç–∞')
plt.grid(axis='y')
plt.show()


# ### –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –ø–æ –¥–≤—É–º –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø—É–Ω–∫—Ç–∞–º:
# - –ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ –¥–Ω—è–º:
#    - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ–±—â–∞—è –≤—ã—Ä—É—á–∫–∞, –æ–±—â–µ–µ –∫–æ–ª-–≤–æ –±–∏–ª–µ—Ç–æ–≤ - –≤ —Ü–µ–ª–æ–º, —ç—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞—Å—Ç—É—Ç;
#    - –ü–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∞—á–∫–∏ –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞:
#      - –æ–±—â–µ–µ –∫–æ–ª-–≤–æ –±–∏–ª–µ—Ç–æ–≤ - –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ —Ä–µ–∑–∫–∏–µ –ø–æ–≤—ã—à–µ–Ω–∏—è –∏ —Å—Ä–∞–∑—É –∂–µ –ø–æ–Ω–∏–∂–µ–Ω–∏—è, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–ª–µ–¥—É–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç;
#      - —Å—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ —Å –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ - —Ä–µ–∑–∫–∏–µ –ø–æ–Ω–∏–∂–µ–Ω–∏—è –≤ –Ω–∞—á–∞–ª–µ –º–µ—Å—è—Ü–∞, –∑–∞—Ç–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ
#      - —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª-–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –≤ —Å–µ–Ω—Ç—è–±—Ä–µ –ø–æ—á—Ç–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ç—Ä–µ—Ö –∑–∞–∫–∞–∑–æ–≤, –∞ –≤ –æ–∫—Ç—è–±—Ä–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –¥–æ 4—Ö –∑–∞–∫–∞–∑–æ–≤. –í –Ω–∞—á–∞–ª–µ –º–µ—Å—è—Ü–∞ —Ä–µ–∑–∫–∏–µ –ø–æ–≤—ã—à–µ–Ω–∏—è
#    - –í–µ—Ä–æ—è—Ç–Ω–æ, –≤ –Ω–∞—á–∞–ª–µ –º–µ—Å—è—Ü–∞ –¥–µ–π—Å—Ç–≤—É—é—Ç –∞–∫—Ü–∏–∏ –∏ –≥–ª—É–±–æ–∫–∏–µ —Å–∫–∏–¥–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤ —Å–≤—è–∑–∏ —Å —á–µ–º –∏ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–µ–∑–∫–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ (–≤–µ—Ä–æ—è—Ç–Ω–æ, –∫–∞–∫ —Ä–∞–∑ –∑–∞ —Å—á–µ—Ç —Å–∫–∏–¥–æ–∫: –±–æ–ª—å—à–µ —Å–∫–∏–¥–∫–∞ = –º–µ–Ω—å—à–µ –≤—ã—Ä—É—á–∫–∞).
# - –ê–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–∏–ø—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏:
#   - –ü–æ—á—Ç–∏ –ø–æ –≤—Å–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º –≤—ã—Ö–æ–¥–∏—Ç, —á—Ç–æ –≤ –±—É–¥–Ω–∏–µ –¥–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã. –í –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ —Ç–æ–ª—å–∫–æ –≤—ã—Ä—É—á–∫–∞ —Å –±–∏–ª–µ—Ç–∞ –≤—ã—à–µ, –Ω–æ –∏ –∑–∞–∫–∞–∑–æ–≤ –º–µ–Ω—å—à–µ, —á–µ–º –≤ –±—É–¥–Ω–∏–µ –¥–Ω–∏

# ## –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã

# ### –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Å–æ–±—ã—Ç–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤—ã–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤–Ω–æ—Å—è—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤–∫–ª–∞–¥ –≤ –≤—ã—Ä—É—á–∫—É.

# - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ—Å—á–∏—Ç–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –æ–±—â–µ–µ —á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤. 
# - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –ø–æ—Å—á–∏—Ç–∞–µ–º –æ–±—â–µ–µ —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ —Å—É–º–º–∞—Ä–Ω—É—é –≤—ã—Ä—É—á–∫—É —Å –∑–∞–∫–∞–∑–æ–≤ –±–∏–ª–µ—Ç–æ–≤.
# - –¢–∞–∫–∂–µ —Ä–∞—Å—á–∏—Ç–∞–µ–º –¥–æ–ª–∏ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –æ—Ç –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞.

# In[70]:


final_df_autumn_regions = final_df_autumn.groupby('region_name').agg({'event_id':'nunique', 'order_id':'count'})
final_df_autumn_regions = final_df_autumn_regions.sort_values(by = 'event_id', ascending = False)
final_df_autumn_regions['part_of_events'] = final_df_autumn_regions['event_id'] / final_df_autumn_regions['event_id'].sum()
final_df_autumn_regions['part_of_orders'] = final_df_autumn_regions['order_id'] / final_df_autumn_regions['order_id'].sum()
display(final_df_autumn_regions.head())


# In[71]:


final_df_autumn_partners = final_df_autumn.groupby('service_name').agg({'event_id':'nunique', 'order_id':'count', 'revenue_rub':'sum'})
final_df_autumn_partners = final_df_autumn_partners.sort_values(by = 'revenue_rub', ascending = False)
final_df_autumn_partners['part_of_events'] = final_df_autumn_partners['event_id'] / final_df_autumn_partners['event_id'].sum()
final_df_autumn_partners['part_of_orders'] = final_df_autumn_partners['order_id'] / final_df_autumn_partners['order_id'].sum()
final_df_autumn_partners['part_of_revenue'] = (final_df_autumn_partners['revenue_rub'] / final_df_autumn_partners['revenue_rub'].sum()).round(4)
final_df_autumn_partners['revenue_rub'] = final_df_autumn_partners['revenue_rub'].round(2)
display(final_df_autumn_partners)


# - –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º

# In[72]:


# –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è
sorted_regions = final_df_autumn_regions.sort_values(by='event_id', ascending=False)

# –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–æ–≤
top_regions = sorted_regions.head(10)

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(15, 5))
plt.bar(top_regions.index, top_regions['event_id'])
plt.title('–¢–æ–ø —Ä–µ–≥–∏–æ–Ω–æ–≤ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π')
plt.xlabel('–†–µ–≥–∏–æ–Ω')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π')
plt.xticks(rotation=90)
plt.grid(axis='y', linestyle='--')
plt.show()


# In[73]:


# –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—ã—Ä—É—á–∫–µ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è
sorted_partners = final_df_autumn_partners.sort_values(by='revenue_rub', ascending=False)

# –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ø-10 –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤
top_partners = sorted_partners.head(10)

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(15, 5))
plt.bar(top_partners.index, top_partners['revenue_rub'])
plt.title('–¢–æ–ø –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ –ø–æ –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–µ')
plt.xlabel('–ü–∞—Ä—Ç–Ω—ë—Ä')
plt.ylabel('–í—ã—Ä—É—á–∫–∞')
plt.xticks(rotation=90)
plt.grid(axis='y', linestyle='--')
plt.show()


# ### –í—ã–≤–æ–¥ –ø–æ —Ç–æ–ø–∞–º:
# - –°—Ä–µ–¥–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–æ–ø-2 –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π:
#   - 1 - –ö–∞–º–µ–Ω–µ–≤—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω - 3893 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è;
#   - 2 - –°–µ–≤–µ—Ä–æ—è—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å - 2594 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø–∏—è—Ç–∏—è.
# - –°—Ä–µ–¥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–æ–ø-6 –ø–æ –æ–±—ä–µ–º—É –≤—ã—Ä—É—á–∫–∏(–≤–∑—è–ª –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç.–∫. –≤—ã—Ä—É—á–∫–∞ - –∫–ª—é—á–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å):
#   - 1 - –ë–∏–ª–µ—Ç—ã –±–µ–∑ –ø—Ä–æ–±–ª–µ–º - 12 106 370;
#   - 2 - –ú–æ–π –±–∏–ª–µ—Ç - 10 833 720;
#   - 3 - –û–±–ª–∞—á–∫–æ - 10 611 050;
#   - 4 - –õ–æ–≤–∏ –±–∏–ª–µ—Ç! - 10 381 140;
#   - 5 - –í–µ—Å—å –≤ –±–∏–ª–µ—Ç–∞—Ö - 9 350 394;
#   - 6 - –ë–∏–ª–µ—Ç—ã –≤ —Ä—É–∫–∏ - 7 610 798.
#   
# 

# ## –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–∏–ø–æ—Ç–µ–∑ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

# ### –ì–∏–ø–æ—Ç–µ–∑–∞ 1: –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

# In[74]:


# –†–∞–∑–¥–µ–ª–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –ø–æ —Ç–∏–ø—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤
group_a = final_df_autumn[final_df_autumn['device_type_canonical'] == 'mobile']
group_b = final_df_autumn[final_df_autumn['device_type_canonical'] == 'desktop']

# –ù–∞—Ö–æ–¥–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
group_a_unique_user_id = group_a['user_id'].unique()
group_b_unique_user_id = group_b['user_id'].unique()

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
intersection_users = set(group_a_unique_user_id) & set(group_b_unique_user_id)
print(intersection_users)


# In[75]:


# –£–¥–∞–ª—è–µ–º –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤
group_a_without_intersection = group_a[~group_a['user_id'].isin(intersection_users)]
group_b_without_intersection = group_b[~group_b['user_id'].isin(intersection_users)]
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
intersection_users_after_removal = set(group_a_without_intersection['user_id']) & set(group_b_without_intersection['user_id'])
print(intersection_users_after_removal)


# - –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã

# In[76]:


# –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
orders_per_user_mobile = group_a_without_intersection.groupby('user_id').agg({'order_id':'count'})
orders_per_user_desktop = group_b_without_intersection.groupby('user_id').agg({'order_id':'count'})

# –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
average_orders_mobile = orders_per_user_mobile['order_id'].mean()
average_orders_desktop = orders_per_user_desktop['order_id'].mean()

print(f"–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: {average_orders_mobile}")
print(f"–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: {average_orders_desktop}")


# - –ü—Ä–æ–≤–µ—Ä–∏–º –æ–±—ä–µ–º –≤—ã–±–æ—Ä–æ–∫:

# In[77]:


gr_a = orders_per_user_mobile['order_id'].count()
print(f"–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –≥—Ä—É–ø–ø—ã –ê: {gr_a}")
gr_b = orders_per_user_desktop['order_id'].count()
print(f"–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –≥—Ä—É–ø–ø—ã –ê: {gr_b}")


# - –†–∞–∑–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏:

# In[78]:


# –û–±—ä—ë–º—ã –≤—ã–±–æ—Ä–æ–∫
sizes = [gr_a, gr_b]

# –ú–µ—Ç–∫–∏ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º
labels = ['Mobile', 'Desktop']

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.figure(figsize=(6, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=140)
plt.axis('equal')  # –ß—Ç–æ–±—ã –¥–∏–∞–≥—Ä–∞–º–º–∞ –±—ã–ª–∞ –∫—Ä—É–≥–ª–æ–π
plt.title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤—ã–±–æ—Ä–æ–∫")
plt.show()


# - –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ –≤—ã–±–æ—Ä–∞—Ö:

# #### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞ –∑–≤—É—á–∏—Ç —Ç–∞–∫: —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü–æ–ø—Ä–æ–±—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑—ã —Å –¥–≤—É–º—è –≤—ã–±–æ—Ä–∫–∞–º–∏:
# 
# - –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÄ: –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
# 
# - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÅ: –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

# - –ü—Ä–æ–≤–µ–¥–µ–º —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –≤ —Å–≤—è–∑–∏ —Å –Ω–∞–ª–∏—á–∏–µ–º –≤—ã–±–æ—Ä–æ–≤

# In[79]:


# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ –ú–∞–Ω–Ω–∞ ‚Äî –£–∏—Ç–Ω–∏
alpha = 0.05
stat, p_value = mannwhitneyu(orders_per_user_mobile, orders_per_user_desktop, alternative='greater')
if p_value > alpha:
    print(f'p-value —Ç–µ—Å—Ç–∞ –ú–∞–Ω–Ω–∞ ‚Äî –£–∏—Ç–Ω–∏ = {round(float(p_value), 2)}')
    print('–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ! –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤')
else:
    print(f'p-value —Ç–µ—Å—Ç–∞ –ú–∞–Ω–Ω–∞ ‚Äî –£–∏—Ç–Ω–∏ = {round(float(p_value), 2)}')
    print('–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è! –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ')


# ### –ì–∏–ø–æ—Ç–µ–∑–∞ 2: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

# In[80]:


# –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
group_a_time = group_a_without_intersection['days_since_prev'].reset_index()
group_b_time = group_b_without_intersection['days_since_prev'].reset_index()
# –£–¥–∞–ª–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ days_since_prev
group_a_time = group_a_time.dropna() 
group_b_time = group_b_time.dropna()
# –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏
average_days_since_prev_mobile = group_a_time['days_since_prev'].mean()
average_days_since_prev_desktop = group_b_time['days_since_prev'].mean()
print(f"–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: {average_days_since_prev_mobile} –¥–Ω–µ–π")
print(f"–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: {average_days_since_prev_desktop} –¥–Ω–µ–π")


# - –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–∑–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫

# In[81]:


gr_a_time = group_a_time['days_since_prev'].count()
print(f"–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –≥—Ä—É–ø–ø—ã –ê: {gr_a_time}")
gr_b_time = group_b_time['days_since_prev'].count()
print(f"–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –≥—Ä—É–ø–ø—ã –ê: {gr_b_time}")


# - –ò —Å–Ω–æ–≤–∞, –∫–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≥–∏–ø–æ—Ç–µ–∑–æ–π - —Ä–∞–∑–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏:

# In[82]:


# –û–±—ä—ë–º—ã –≤—ã–±–æ—Ä–æ–∫
sizes = [gr_a_time, gr_b_time]  

# –ú–µ—Ç–∫–∏ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º
labels = ['Mobile', 'Desktop']

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
plt.figure(figsize=(6, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=140)
plt.axis('equal')  # –ß—Ç–æ–±—ã –¥–∏–∞–≥—Ä–∞–º–º–∞ –±—ã–ª–∞ –∫—Ä—É–≥–ª–æ–π
plt.title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –≤—ã–±–æ—Ä–æ–∫")
plt.show()


# - –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ –≤—ã–±–æ—Ä–∞—Ö:

# #### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞ –∑–≤—É—á–∏—Ç —Ç–∞–∫: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü–æ–ø—Ä–æ–±—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑—ã —Å –¥–≤—É–º—è –≤—ã–±–æ—Ä–∫–∞–º–∏:
# 
# - –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÄ: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–µ –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
# 
# - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÅ: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

# - –ü—Ä–æ–≤–µ–¥–µ–º —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –≤ —Å–≤—è–∑–∏ —Å –Ω–∞–ª–∏—á–∏–µ–º –≤—ã–±–æ—Ä–æ–≤

# In[83]:


# –ü—Ä–æ–≤–æ–¥–∏–º —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏
alpha = 0.05
stat, p_value = mannwhitneyu(group_a_time['days_since_prev'], group_b_time['days_since_prev'], alternative='greater')

if p_value > alpha:
    print(f'p-value —Ç–µ—Å—Ç–∞ –ú–∞–Ω–Ω–∞ ‚Äî –£–∏—Ç–Ω–∏ = {round(p_value, 2)}')
    print('–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ! –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.')
else:
    print(f'p-value —Ç–µ—Å—Ç–∞ –ú–∞–Ω–Ω–∞ ‚Äî –£–∏—Ç–Ω–∏ = {round(p_value, 2)}')
    print('–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è! –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ.')
 


# # –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# 

# ### –ò—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–∏—Å–µ –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 –∏—é–Ω—è –ø–æ 30 –æ–∫—Ç—è–±—Ä—è 2024 –≥–æ–¥–∞:
#   - –ø—Ä–æ–≤–µ–ª–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö, –∞ –∏–º–µ–Ω–Ω–æ: —É–¥–∞–ª–∏–ª–∏ —á–∞—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–æ–≤; –æ—Ç—á–∏—Å—Ç–∏–ª–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤; –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ–º —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç–∏; –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –∏ —É—Å—Ç—Ä–∞–Ω–∏–ª–∏ –≤—ã–±—Ä–æ—Å—ã; –¥–æ–ø–æ–ª–Ω–∏–ª–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞; 
#   - –ø—Ä–æ–≤–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º –∏ –∏—Ö —Å–µ–∑–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è; –æ—Å–µ–Ω–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π; –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã;
#   - –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –∑–∞–∫–∞–∑—á–∏–∫–∞ –ø—É—Ç–µ–º –ê/–ë —Ç–µ—Å—Ç–æ–≤.

# ### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞: 
# - –Ω–∞–∏–±–æ–ª–µ–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–ø–æ—Å—á–∏—Ç–∞–ª–∏ –≤ –≤–∏–¥–µ –¥–æ–ª–µ–π –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π):
#   - –ö–æ–Ω—Ü–µ—Ä—Ç—ã - –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.44 –ª–µ—Ç–æ–º, 0.37 –æ—Å–µ–Ω—å—é
#   - –¢–µ–∞—Ç—Ä—ã - –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.25 –æ—Å–µ–Ω—å—é, 0.21 –ª–µ—Ç–æ–º
# - –æ—Å–µ–Ω—å—é –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –ø–æ–≤—ã—Å–∏–ª–∞—Å—å —É —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π:
#   - —Ç–µ–∞—Ç—Ä - –ª–µ—Ç–æ–º –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.20, –æ—Å–µ–Ω—å—é 0.25
#   - —Å–ø–æ—Ä—Ç - –ª–µ—Ç–æ–º –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ 0.02, –æ—Å–µ–Ω—å—é 0.11
# - —Å–∞–º–æ–µ –∑–∞–º–µ—Ç–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –æ—Å–µ–Ω—å—é –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π "—Å—Ç–µ–Ω–¥–∞–ø" (–ø–æ–≤—ã—à–µ–Ω–∏–µ –Ω–∞ 6.25%)
# - —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—ã–ø–∞–¥–∞–µ—Ç –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–µ–Ω—Ç—è–±—Ä—è –∏ –æ–∫—Ç—è–±—Ä—è. –í–µ—Ä–æ—è—Ç–Ω–æ, –≤ —ç—Ç–∏ –¥–∞—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç –∞–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏, —Ç.–∫. –∫–æ–ª-–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –∏ —Ç–∞–∫–∂–µ —Ä–µ–∑–∫–æ –ø–∞–¥–∞–µ—Ç –≤—ã—Ä—É—á–∫–∞, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –≥–ª—É–±–æ–∫–∏—Ö —Å–∫–∏–¥–∫–∞—Ö. –î–∞–ª–µ–µ –≤–∏–¥–∏–º –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏—Ç–æ–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∞–∫—Ü–∏–∏/—Å–∫–∏–¥–∫–∏, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ (–∫–∞–∫ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º–∏);
# - —Å—Ä–µ–¥–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —è–≤–Ω—ã–µ –ª–∏–¥–µ—Ä—ã –ø–æ —á–∏—Å–ª—É –∑–∞–∫–∞–∑–æ–≤ –∏ –≤—ã—Ä—É—á–∫–µ —Å –ø—Ä–æ–¥–∞–∂–∏ –±–∏–ª–µ—Ç–æ–≤:
#   - —Å—Ä–µ–¥–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–æ–ø-2 –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π:
#     - 1 - –ö–∞–º–µ–Ω–µ–≤—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω - 3893 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è;
#     - 2 - –°–µ–≤–µ—Ä–æ—è—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å - 2594 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø–∏—è—Ç–∏—è.
#   - —Å—Ä–µ–¥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–æ–ø-6 –ø–æ –æ–±—ä–µ–º—É –≤—ã—Ä—É—á–∫–∏(–≤–∑—è–ª –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç.–∫. –≤—ã—Ä—É—á–∫–∞ - –∫–ª—é—á–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å):
#     - 1 - –ë–∏–ª–µ—Ç—ã –±–µ–∑ –ø—Ä–æ–±–ª–µ–º - 12 106 370;
#     - 2 - –ú–æ–π –±–∏–ª–µ—Ç - 10 833 720;
#     - 3 - –û–±–ª–∞—á–∫–æ - 10 611 050;
#     - 4 - –õ–æ–≤–∏ –±–∏–ª–µ—Ç! - 10 381 140;
#     - 5 - –í–µ—Å—å –≤ –±–∏–ª–µ—Ç–∞—Ö - 9 350 394;
#     - 6 - –ë–∏–ª–µ—Ç—ã –≤ —Ä—É–∫–∏ - 7 610 798.
# - –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–≤—É—Ö –≥–∏–ø–æ—Ç–µ–∑, –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –Ω—É–ª–µ–≤—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã –±—ã–ª–∏ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—ã –≤ –ø–æ–ª—å–∑—É –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö, –∞ –∏–º–µ–Ω–Ω–æ:
#   - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ
#   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ.

# ### –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –º–æ–∂–Ω–æ –¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:
# - –ê–Ω–∞–ª–∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π:
#   - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å, —Å —á–µ–º —Å–≤—è–∑–∞–Ω–æ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –∏ —Ç–µ–∞—Ç—Ä–æ–≤. –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π —Å —É—á—ë—Ç–æ–º —ç—Ç–∏—Ö —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω–∏–º–∞ –ª–∏ —Ç–∞ –∂–µ –ª–æ–≥–∏–∫–∞ –∫ –¥—Ä—É–≥–∏–º –º–µ—Ä–æ–ø–∏—è—Ç–∏—è–º, –¥–∞–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∏ –∏—Ö –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å;
# - –ê–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏:
#   - —Å—É–¥—è –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º - —Ä–æ—Å—Ç –ø—Ä–∏—Ç–æ–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Å–ø–æ—Å–æ–±—ã –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –∏—Ö –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏ –¥–∞–ª—å—à–µ.
#   - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–Ω–æ –ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Å—Ç–æ–ª—å —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–∏ –∑–∞ –±–∏–ª–µ—Ç.
# - –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è:
#   - –ö–∞–º–µ–Ω–µ–≤—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω –∏ –°–µ–≤–µ—Ä–æ—è—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å —è–≤–ª—è—é—Ç—Å—è —Ç–æ–ø–æ–≤—ã–º–∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –õ–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ —Å–ø—Ä–æ—Å –≤ —ç—Ç–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫ –∏ –º–æ–∂–Ω–æ –≤–ª–æ–∂–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ä—ã–Ω–∫–∞ –∏–º–µ–Ω–Ω–æ –≤ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.
#   - –Ω–µ —Å—Ç–æ–∏—Ç –∑–∞–±—ã–≤–∞—Ç—å –∏ –ø—Ä–æ —Ä–µ–≥–∏–æ–Ω—ã —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏, —á–µ–º –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ç–æ–ø-2, –Ω–æ –Ω–µ –≤ –º–æ–º–µ–Ω—Ç —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏–∏ –∑–∞–¥–∞—á–∏. –õ—É—á—à–µ —É–¥–µ–ª–∏—Ç—å —ç—Ç–æ–º—É –≤—Ä–µ–º—è —É–∂–µ –ø–æ—Å–ª–µ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤. 
# - –°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ —Å –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏:
#   - –æ—Ü–µ–Ω–∏—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —Å —Ç–æ–ø–æ–≤—ã–º–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ –ø–æ –æ–±—ä—ë–º—É –≤—ã—Ä—É—á–∫–∏. –ö–∞–∫–∏–µ —Å–ø–æ–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏–º—ã –∫ –Ω–∏–º, —á—Ç–æ–±—ã —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–æ—è–≤–ª—è—Ç—å –≤—ã—Å–æ–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–¥–∞–∂–µ –±–∏–ª–µ—Ç–æ–≤. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –º–æ–∂–Ω–æ —Ä–∞—Å–∫—Ä—É—Ç–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ç–æ–ø–æ–≤—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤;
# - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
#   - —Ç–µ—Å—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á–µ–º —Å–æ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –Ω–æ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è –∏ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏ —Å –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—ã—à–µ. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –Ω–∞ –∫–∞–∫–∏—Ö —ç—Ç–∞–ø–∞—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏/–±–∞–≥–∏ –∏ —Ç.–ø. –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –∏—Ö. –¢–∞–∫–∂–µ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–∞—â–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é –∞–∫—Ü–∏–π, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

# In[ ]:




